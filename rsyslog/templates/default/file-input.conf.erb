# <%= @tag %>.conf - Syslog file inputs for <%= @tag %>
#
# Generated by Chef for <%= node['fqdn'] %>
# Local modifications will be overwritten.
$ModLoad imfile
$InputFileName <%= @file_name %>
$InputFileTag <%= @tag %>
$InputFileStateFile <%= @state_file %>
$InputFileSeverity <%= @severity %>
$InputFileFacility <%= @facility %>
$InputRunFileMonitor

<% @servers.each do |server| -%>
<%   case node['rsyslog']['protocol'] -%>
<%   when "tcp" -%>
<%= node['rsyslog']['logs_to_forward'] %> @@<%= server %>:<%= node['rsyslog']['port'] %><%= node["rsyslog"]["default_remote_template"] ? ';' + node["rsyslog"]["default_remote_template"] : nil %>
<%   when "udp" -%>
<%= node['rsyslog']['logs_to_forward'] %> @<%= server %>:<%= node['rsyslog']['port'] %><%= node["rsyslog"]["default_remote_template"] ? ';' + node["rsyslog"]["default_remote_template"] : nil %>
<%   end -%>
<% end -%>